<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/mikaelbr/mversion#readme"

    >mversion (v1.10.1)</a>
</h1>
<h4>A cross packaging manager module version handler/bumper</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.mversion">module mversion</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.get">
            function <span class="apidocSignatureSpan">mversion.</span>get
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.isPackageFile">
            function <span class="apidocSignatureSpan">mversion.</span>isPackageFile
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.update">
            function <span class="apidocSignatureSpan">mversion.</span>update
            <span class="apidocSignatureSpan">(options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.updateJSON">
            function <span class="apidocSignatureSpan">mversion.</span>updateJSON
            <span class="apidocSignatureSpan">(obj, ver)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mversion.</span>files</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mversion.</span>scripts</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mversion.</span>versionAliases</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mversion.files">module mversion.files</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.files.getLastChar">
            function <span class="apidocSignatureSpan">mversion.files.</span>getLastChar
            <span class="apidocSignatureSpan">(json)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.files.getRC">
            function <span class="apidocSignatureSpan">mversion.files.</span>getRC
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.files.isPackageFile">
            function <span class="apidocSignatureSpan">mversion.files.</span>isPackageFile
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.files.loadFiles">
            function <span class="apidocSignatureSpan">mversion.files.</span>loadFiles
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.files.space">
            function <span class="apidocSignatureSpan">mversion.files.</span>space
            <span class="apidocSignatureSpan">(json)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mversion.files.</span>_files</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mversion.scripts">module mversion.scripts</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mversion.scripts.run">
            function <span class="apidocSignatureSpan">mversion.scripts.</span>run
            <span class="apidocSignatureSpan">(script, cb)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mversion" id="apidoc.module.mversion">module mversion</a></h1>


    <h2>
        <a href="#apidoc.element.mversion.get" id="apidoc.element.mversion.get">
        function <span class="apidocSignatureSpan">mversion.</span>get
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (callback) {
  var result = fUtil.loadFiles();
  var ret = {};
  var errors = [];

  return result
    .on(&#x27;data&#x27;, function (file) {
      try {
        var contents = JSON.parse(file.contents.toString());
        ret[path.basename(file.path)] = contents.version;
      } catch (e) {
        errors.push(file.relative + &#x22;: &#x22; + e.message);
      }
    })
    .on(&#x27;end&#x27;, function () {
      if (errors.length) {
        return callback(new Error(errors.join(&#x27;\n&#x27;)), ret);
      }
      return callback(null, ret);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```shell
npm install mversion
```

```javascript
var mversion = require(&#x27;mversion&#x27;);

mversion.<span class="apidocCodeKeywordSpan">get</span>(function (err, data) {
  /*
    data = {
      &#x27;package.json&#x27;: VERSION,
      &#x27;component.json&#x27;: VERSION
    }
  */
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mversion.isPackageFile" id="apidoc.element.mversion.isPackageFile">
        function <span class="apidocSignatureSpan">mversion.</span>isPackageFile
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPackageFile = function (file) {
  for (var i = 0; i &#x3c; exports._files.length; i++) {
    if (minimatch(file, exports._files[i])) {
      return true;
    }
  }
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  version: &#x27;major&#x27;,
  commitMessage: &#x27;Bumps to version %s&#x27;,
  tagName: &#x27;%s&#x27;
});
// Might produce annotated tag named 1.0.0
```

### `mversion.<span class="apidocCodeKeywordSpan">isPackageFile</span>(filename) : Boolean`
Checks whether or not the given filename is a valid package file type.

Examples:
```javascript
assert.equal(mversion.isPackageFile(&#x27;package.json&#x27;), true);
assert.equal(mversion.isPackageFile(&#x27;component.json&#x27;), true);
assert.equal(mversion.isPackageFile(&#x27;bower.json&#x27;), true);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mversion.update" id="apidoc.element.mversion.update">
        function <span class="apidocSignatureSpan">mversion.</span>update
        <span class="apidocSignatureSpan">(options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (options, callback) {
  if (typeof options === &#x22;function&#x22;) {
    callback = options;
    options = {};
  }

  options = options || {};

  if (typeof options === &#x22;string&#x22;) {
    options = {
      version: options,
      noPrefix: false,
      precommit: void 0,
      commitMessage: void 0
    };
  }

  if (!options.tagName) {
    options.tagName = (options.noPrefix ? &#x27;&#x27; : &#x27;v&#x27;) + &#x27;%s&#x27;;
  }

  var ver = options.version || &#x27;minor&#x27;;
  var noPrefix = !!options.noPrefix;
  var commitMessage = options.commitMessage || void 0;
  var precommitCallback = options.precommit;
  callback = callback || noop();

  (function (done) {
    if (commitMessage) {
      return git.isRepositoryClean(done);
    }
    return done(null);
  })(function(err) {
    if (err) {
      callback(err);
      return void 0;
    }

    var files = [],
        errors = [],
        fileStream = fUtil.loadFiles(),
        versionList = {},
        updated = null,
        hasSet = false;

    var stored = fileStream.pipe(through.obj(function(file, e, next) {
      if (file == null || file.isNull()) {
        this.push(null);
        next();
        return;
      }
      var json = file.contents.toString(),
          contents = null;

      try {
        contents = JSON.parse(json);
      } catch (e) {
        errors.push(new Error(file.relative + &#x27;: &#x27; + e.message));
        next();
        return;
      }

      if (!hasSet) {
        hasSet = true;
        updated = updateJSON(contents, ver);

        if (!updated) {
          this.emit(&#x27;error&#x27;, new Error(&#x27;Version bump failed, &#x27; + ver + &#x27; is not valid version.&#x27;))
          return void 0;
        }
      }

      contents.version = updated.version;
      file.contents = new Buffer(JSON.stringify(contents, null, fUtil.space(json)) + fUtil.getLastChar(json));
      versionList[path.basename(file.path)] = updated.version;

      this.push(file);
      next();
    }))
    .on(&#x27;error&#x27;, function (err) {
      callback(err);
    })
    .pipe(fs.dest(&#x27;./&#x27;));

    stored.on(&#x27;data&#x27;, function (file) {
      files.push(file.path);
    });

    stored.on(&#x27;end&#x27;, function () {
      var errorMessage = null;
      if (errors.length) {
        errorMessage = errors.map(function (e) {
          return &#x22; * &#x22; + e.message;
        }).join(&#x27;\n&#x27;);
      }

      updated = updated || { version: &#x27;N/A&#x27; };

      var ret = {
        newVersion: updated.version,
        versions: versionList,
        message: files.map(function (file) {
          return &#x27;Updated &#x27; + path.basename(file);
        }).join(&#x27;\n&#x27;),
        updatedFiles: files
      };

      if (!commitMessage || errorMessage) {
        callback(errorMessage ? new Error(errorMessage) : null, ret);
        return void 0;
      }

      if (!precommitCallback) {
        return doCommit();
      }

      precommitCallback(function (err) {
        if (err) {
          return git.checkout();
        }
        doCommit();
      });

      function doCommit () {
        var tagName = options.tagName.replace(&#x27;%s&#x27;, updated.version).replace(&#x27;&#x22;&#x27;, &#x27;&#x27;).replace(&#x22;&#x27;&#x22;, &#x27;&#x27;);
        git.commit(files, commitMessage, updated.version, tagName, function (err) {
          if (err) {
            callback(err, null);
            return void 0;
          }

          ret.message += &#x27;\nCommited to git and created tag &#x27; + tagName;
          callback(null, ret);
        });
      }
    });
  });
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
data = {
  &#x27;package.json&#x27;: VERSION,
  &#x27;component.json&#x27;: VERSION
}
  */
});

mversion.<span class="apidocCodeKeywordSpan">update</span>(&#x27;minor&#x27;, function (err, data) { })
mversion.update(&#x27;major&#x27;, function (err, data) { })
mversion.update({
version: &#x27;major&#x27;,
commitMessage: &#x27;Some commit message for version %s&#x27;
  }, function (err, data) { }) // Will commit/tag
mversion.update({
version: &#x27;major&#x27;,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mversion.updateJSON" id="apidoc.element.mversion.updateJSON">
        function <span class="apidocSignatureSpan">mversion.</span>updateJSON
        <span class="apidocSignatureSpan">(obj, ver)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateJSON = function (obj, ver) {
  ver = ver.toString().toLowerCase();

  // check for aliases
  if(ver in versionAliases){
    ver = versionAliases[ver];
  }

  var validVer = semver.valid(ver);
  obj = obj || {};
  var currentVer = obj.version;

  if (validVer === null) {
    validVer = semver.inc(currentVer, ver);
  }

  if (validVer === null) {
    return false;
  }

  obj.version = validVer;
  return obj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mversion.files" id="apidoc.module.mversion.files">module mversion.files</a></h1>


    <h2>
        <a href="#apidoc.element.mversion.files.getLastChar" id="apidoc.element.mversion.files.getLastChar">
        function <span class="apidocSignatureSpan">mversion.files.</span>getLastChar
        <span class="apidocSignatureSpan">(json)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getLastChar = function (json) {
  return (json.slice(-1) === &#x27;\n&#x27;) ? &#x27;\n&#x27; : &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (!updated) {
      this.emit(&#x27;error&#x27;, new Error(&#x27;Version bump failed, &#x27; + ver + &#x27; is not valid version.&#x27;))
      return void 0;
    }
  }

  contents.version = updated.version;
  file.contents = new Buffer(JSON.stringify(contents, null, fUtil.space(json)) + fUtil.<span class="apidocCodeKeywordSpan">getLastChar
</span>(json));
  versionList[path.basename(file.path)] = updated.version;

  this.push(file);
  next();
}))
.on(&#x27;error&#x27;, function (err) {
  callback(err);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mversion.files.getRC" id="apidoc.element.mversion.files.getRC">
        function <span class="apidocSignatureSpan">mversion.files.</span>getRC
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRC = function () {
  return rc(&#x27;mversion&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (typeof loggers === &#x27;function&#x27; || !loggers) {
  processCallback = loggers;
  loggers = {};
}
var logger = loggers.logger || console.log.bind(console);
var errorLogger = loggers.errorLogger || console.error.bind(console);

var rc = files.<span class="apidocCodeKeywordSpan">getRC</span>();

processCallback = processCallback || function () { };

var parsedArguments = require(&#x27;minimist&#x27;)(argv, {
  &#x27;string&#x27;: [&#x27;t&#x27;, &#x27;tag&#x27;],
  &#x27;boolean&#x27;: [&#x27;n&#x27;]
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mversion.files.isPackageFile" id="apidoc.element.mversion.files.isPackageFile">
        function <span class="apidocSignatureSpan">mversion.files.</span>isPackageFile
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isPackageFile = function (file) {
  for (var i = 0; i &#x3c; exports._files.length; i++) {
    if (minimatch(file, exports._files[i])) {
      return true;
    }
  }
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  version: &#x27;major&#x27;,
  commitMessage: &#x27;Bumps to version %s&#x27;,
  tagName: &#x27;%s&#x27;
});
// Might produce annotated tag named 1.0.0
```

### `mversion.<span class="apidocCodeKeywordSpan">isPackageFile</span>(filename) : Boolean`
Checks whether or not the given filename is a valid package file type.

Examples:
```javascript
assert.equal(mversion.isPackageFile(&#x27;package.json&#x27;), true);
assert.equal(mversion.isPackageFile(&#x27;component.json&#x27;), true);
assert.equal(mversion.isPackageFile(&#x27;bower.json&#x27;), true);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mversion.files.loadFiles" id="apidoc.element.mversion.files.loadFiles">
        function <span class="apidocSignatureSpan">mversion.files.</span>loadFiles
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadFiles = function () {
  return fs.src(exports._files);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  path = require(&#x27;path&#x27;),
  through = require(&#x27;through2&#x27;),
  fs = require(&#x27;vinyl-fs&#x27;),
  fUtil = require(&#x27;./lib/files&#x27;),
  git = require(&#x27;./lib/git&#x27;);

exports.get = function (callback) {
var result = fUtil.<span class="apidocCodeKeywordSpan">loadFiles</span>();
var ret = {};
var errors = [];

return result
  .on(&#x27;data&#x27;, function (file) {
    try {
      var contents = JSON.parse(file.contents.toString());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mversion.files.space" id="apidoc.element.mversion.files.space">
        function <span class="apidocSignatureSpan">mversion.files.</span>space
        <span class="apidocSignatureSpan">(json)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">space = function (json) {
    var match = json.match(/^(?:(\t+)|( +))&#x22;/m);
    return match ? (match[1] ? &#x27;\t&#x27; : match[2].length) : &#x27;&#x27;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (!updated) {
      this.emit(&#x27;error&#x27;, new Error(&#x27;Version bump failed, &#x27; + ver + &#x27; is not valid version.&#x27;))
      return void 0;
    }
  }

  contents.version = updated.version;
  file.contents = new Buffer(JSON.stringify(contents, null, fUtil.<span class="apidocCodeKeywordSpan">space</span>(json)) + fUtil
.getLastChar(json));
  versionList[path.basename(file.path)] = updated.version;

  this.push(file);
  next();
}))
.on(&#x27;error&#x27;, function (err) {
  callback(err);
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mversion.scripts" id="apidoc.module.mversion.scripts">module mversion.scripts</a></h1>


    <h2>
        <a href="#apidoc.element.mversion.scripts.run" id="apidoc.element.mversion.scripts.run">
        function <span class="apidocSignatureSpan">mversion.scripts.</span>run
        <span class="apidocSignatureSpan">(script, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (script, cb) {
  return exec(script, {
    cwd: process.cwd()
  }, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return get();
}

if (!rc.scripts || !rc.scripts.preupdate) {
  return update();
}

return scripts.<span class="apidocCodeKeywordSpan">run</span>(
  rc.scripts.preupdate,
  scriptsCallback(&#x27;preupdate&#x27;, update)
);

function get() {
  mversion.get(function (err, data) {
    if (err) {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
